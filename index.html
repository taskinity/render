<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taskinity Render - Local Preview</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #24292e;
            max-width: 1012px;
            margin: 0 auto;
            padding: 16px;
        }
        pre {
            background-color: #f6f8fa;
            border-radius: 6px;
            padding: 16px;
            overflow: auto;
        }
        .taskinity-diagram {
            margin: 1em 0;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            padding: 16px;
            background: white;
        }
    </style>
</head>
<body>
    <h1>Taskinity Render - Local Preview</h1>
    
    <h2>DSL Example</h2>
    
    <pre><code class="language-dsl">flow EmailProcessing:
    description: "Email Processing Flow"
    fetch_emails -> classify_emails
    classify_emails -> process_urgent_emails
    classify_emails -> process_regular_emails
    
    # This is a comment
    process_urgent_emails -> send_urgent_notifications
    process_regular_emails -> archive_emails</code></pre>

    <h2>Another Example</h2>
    
    <pre><code class="language-dsl">flow UserRegistration:
    description: "User Registration Flow"
    start -> validate_input
    validate_input -> check_email_availability
    check_email_availability -> create_user_account
    create_user_account -> send_welcome_email
    send_welcome_email -> complete_registration</code></pre>

    <!-- Load Taskinity Render -->
    <script>
        // Configuration object that will be used to initialize TaskinityRender
        window.taskinityRenderConfig = {
            theme: 'github',
            lineNumbers: true,
            copyButton: true
        };

        // Error handler for script loading
        function handleScriptError(error) {
            console.error('Error loading Taskinity Render:', error);
            // Show a user-friendly error message
            const errorDiv = document.createElement('div');
            errorDiv.style.cssText = 'background: #ffebee; border-left: 4px solid #f44336; color: #b71c1c; padding: 1em; margin: 1em 0; border-radius: 4px;';
            errorDiv.innerHTML = `
                <h3 style="margin-top: 0;">Error loading Taskinity Render</h3>
                <p>Failed to load the Taskinity Render script. Please check the following:</p>
                <ol>
                    <li>Make sure the file <code>dist/taskinity-render.min.js</code> exists</li>
                    <li>Verify the file permissions are correct</li>
                    <li>Check the browser's console for detailed error messages</li>
                </ol>
                <p>If the problem persists, please <a href="https://github.com/taskinity/render/issues" target="_blank">report this issue</a>.</p>
            `;
            document.body.insertBefore(errorDiv, document.body.firstChild);
        }

        // Load the script dynamically
        document.addEventListener('DOMContentLoaded', function() {
            const script = document.createElement('script');
            script.src = 'dist/taskinity-render.min.js';
            script.onerror = function() {
                handleScriptError(new Error('Failed to load script: ' + script.src));
            };
            script.onload = function() {
                try {
                    // Initialize Taskinity Render with the configuration
                    if (typeof TaskinityRender === 'function') {
                        window.taskinityRender = new TaskinityRender(window.taskinityRenderConfig);
                        console.log('Taskinity Render initialized successfully!');
                    } else {
                        throw new Error('TaskinityRender is not defined');
                    }
                } catch (error) {
                    handleScriptError(error);
                }
            };
            document.head.appendChild(script);
        });
    </script>
</body>
</html>
